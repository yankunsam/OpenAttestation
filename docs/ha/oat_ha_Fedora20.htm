<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:110%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:20.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:8.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	font-weight:normal;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#404040;
	font-weight:normal;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri Light",sans-serif;
	font-weight:normal;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	font-weight:normal;
	font-style:italic;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"Calibri Light",sans-serif;
	color:#595959;
	font-weight:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"Calibri Light",sans-serif;
	color:#595959;
	font-style:italic;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"Heading 8 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:#595959;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-link:"Heading 9 Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:#595959;
	font-style:italic;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:110%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:110%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:110%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:#404040;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:40.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	letter-spacing:-.35pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:40.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	letter-spacing:-.35pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:40.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	letter-spacing:-.35pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:40.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	letter-spacing:-.35pt;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-link:"Subtitle Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	font-size:15.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#404040;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
code
	{font-family:"Courier New";}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:"Segoe UI",sans-serif;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	line-height:110%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:110%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:110%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	line-height:110%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-link:"Quote Char";
	margin-top:12.0pt;
	margin-right:.6in;
	margin-bottom:12.0pt;
	margin-left:.6in;
	text-align:center;
	line-height:105%;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-link:"Intense Quote Char";
	margin-right:.6in;
	margin-bottom:12.0pt;
	margin-left:.6in;
	text-align:center;
	line-height:110%;
	font-size:14.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#5B9BD5;}
span.MsoSubtleEmphasis
	{color:#595959;
	font-style:italic;}
span.MsoIntenseEmphasis
	{font-weight:bold;
	font-style:italic;}
span.MsoSubtleReference
	{font-variant:small-caps;
	color:#404040;}
span.MsoIntenseReference
	{font-variant:small-caps;
	font-weight:bold;
	text-decoration:underline;}
span.MsoBookTitle
	{font-variant:small-caps;
	font-weight:bold;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:20.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;
	letter-spacing:-.35pt;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri Light",sans-serif;
	color:#2E74B5;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-link:Subtitle;
	font-family:"Calibri Light",sans-serif;
	color:#404040;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri Light",sans-serif;
	color:#404040;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Calibri Light",sans-serif;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Calibri Light",sans-serif;
	font-style:italic;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"Calibri Light",sans-serif;
	color:#595959;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"Calibri Light",sans-serif;
	color:#595959;
	font-style:italic;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-link:"Heading 8";
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:#595959;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-link:"Heading 9";
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:#595959;
	font-style:italic;}
span.QuoteChar
	{mso-style-name:"Quote Char";
	mso-style-link:Quote;
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-link:"Intense Quote";
	font-family:"Calibri Light",sans-serif;
	color:#5B9BD5;}
span.apple-converted-space
	{mso-style-name:apple-converted-space;}
span.line
	{mso-style-name:line;}
span.nv
	{mso-style-name:nv;}
span.s1
	{mso-style-name:s1;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:"Courier New";}
span.line-number
	{mso-style-name:line-number;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Segoe UI",sans-serif;}
.MsoChpDefault
	{font-size:10.5pt;}
.MsoPapDefault
	{margin-bottom:6.0pt;
	line-height:110%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72">

<div class=WordSection1>

<p class=MsoTitle align=center style='text-align:center'><span
style='font-size:28.0pt'>OAT High Availability Deployment</span></p>

<div style='border:none;border-bottom:solid #5B9BD5 1.0pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoTocHeading>Table of Contents</p>

</div>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc407711409">Preface<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc407711410">Prerequisites<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711411">Local Name
Resolution<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711412">SSH
Password-less Connection between Hosts<span style='color:windowtext;display:
none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc407711413">Deploy the
Web Applications with Load Balancers<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711414">Set up
Haproxy<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711415">Enable
Haproxy logging<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711416">Enable the
Haproxy ports in Firewalld<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc407711417">Deploy the
Web Applications with HA &amp; Load Balancer<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711418">Set up
Keepalived<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711419">Deploy
Mariadb and Galera Replicator<span style='color:windowtext;display:none;
text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711420">Setup Web
Applications<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc407711421">Deploy
Mariadb with HA<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711422">Galera
Configuration with Three-node Cluster<span style='color:windowtext;display:
none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711423">Configure
SELinux for Galera<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711424">Configure
Mariadb with HA &amp; Load Balancers<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc407711425">Recover
after a Failure<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711426">Reboot a
Failed Node<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc407711427">Replace a
Failed Node<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc407711428">References<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>0</span></a></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoTitle align=right style='text-align:right'>&nbsp;</p>

<p class=MsoNormal align=right style='text-align:right'>&nbsp;</p>

<div style='border:none;border-bottom:solid #5B9BD5 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1 style='page-break-before:always'><a name="_Toc407711409">Preface</a></h1>

</div>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>In
this guide, we will provide you with the complete deployment process of the OAT
HA (high availability) solution. In this solution, we are using HAProxy to
construct a highly available and scalable web cluster with two load balancers,
two web servers and three Mysql servers. In addition, Keepalived, a framework
for server failover, is also included to avoid the single point of failure
(SNOF). The detailed topology is described in the following figure. </p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><img
width=720 height=395 id="Picture 1" src="oat_ha_files/image001.jpg"></p>

<div style='border:none;border-bottom:solid #5B9BD5 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc407711410">Prerequisites</a></h1>

</div>

<p class=MsoNormal>A minimum of three servers are required for this
implementation. The deployment environment has been validated in Ubuntu 14.04.1,
Fedora 21/20, RHEL 7 and SLES 12. This guide is intended for Fedora 20.</p>

<h2><a name="_Toc407711411">Local Name Resolution</a></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Edit
/etc/hosts and match the host name with its IP address in the cluster. Make
sure the connectivity among hosts.</p>

<h2><a name="_Toc407711412">SSH Password-less Connection between Hosts</a></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Create
the ssh key pair with ssh-keygen and paste the public key to the
$HOME/.ssh/authorized_keys file of the target server and vice versa.</p>

<div style='border:none;border-bottom:solid #5B9BD5 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc407711413">Deploy the Web Applications with Load Balancers</a></h1>

</div>

<h2 style='text-align:justify;text-justify:inter-ideograph'><a
name="_Toc407711414"><span class=MsoIntenseEmphasis><span style='font-weight:
normal;font-style:normal'>Set up Haproxy</span></span></a></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>HAProxy
is renowned for one of the most popular load balancing and proxying solution.
In our deployment, HAProxy is used to balance the load of the two web
applications. </p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>To
install haproxy:</p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># yum install -y haproxy </span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># chkconfig haproxy on</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># setsebool -P haproxy_connect_any on</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>If
you failed to set the selinux policy and got the error ¡°Boolean
haproxy_connect_any is not defined¡±, then update your selinux policy by the
following command:</p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># yum update selinux-policy</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Backup
the original haproxy configuration.</p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># mv /etc/haproxy/haproxy.cfg
/etc/haproxy/haproxy_backup.cfg</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># vim /etc/haproxy/haproxy.cfg</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='border:solid windowtext 1.0pt !msorm;padding:
0in !msorm'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
background:#D9D9D9'>&nbsp;</span></span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>Create
a new one with the following settings:</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>global</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
maxconn 4096</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
user haproxy</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
group haproxy</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
log 127.0.0.1 local1 debug</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
daemon</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>defaults</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
log&nbsp;&nbsp;&nbsp;&nbsp; global</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mode&nbsp;&nbsp;&nbsp; http</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option&nbsp; dontlognull</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retries 3</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option&nbsp; redispatch</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
maxconn 2000</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
contimeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5000</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
clitimeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 50000</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
srvtimeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 50000</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>frontend
http-in</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mode&nbsp;&nbsp;&nbsp; http</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option&nbsp; httplog</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
bind&nbsp;&nbsp;&nbsp; *:442</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
reqadd X-Forwarded-Proto:\ http</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
acl is_whitelist path_beg -i /WhiteListPortal</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
use_backend whitelist_portal if is_whitelist</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
default_backend trust_dashboard_portal</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>backend
trust_dashboard_portal</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mode&nbsp;&nbsp;&nbsp; http</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
balance roundrobin</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option httpchk HEAD /TrustDashBoard/login.htm HTTP/1.1\r\nHost:\ *:8080</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option forwardfor</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cookie LSW_WEB insert</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option httpclose</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb1 hostname&gt; &lt;lb1 IP&gt;:8080 cookie LSW_WEB01 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb2 hostname&gt; &lt;lb2 IP&gt;:8080 cookie LSW_WEB02 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>backend
whitelist_portal</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mode&nbsp;&nbsp;&nbsp; http</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
balance roundrobin</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option httpchk HEAD /WhiteListPortal HTTP/1.1\r\nHost:\ *:8080</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option forwardfor</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cookie LSW_WEB insert</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option httpclose</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style='background:black'>server &lt;lb1 hostname&gt; &lt;lb1 IP&gt;:8080
cookie LSW_WEB01 check</span></span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb2 hostname&gt; &lt;lb2 IP&gt;:8080 cookie LSW_WEB02 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>frontend
https-in</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
bind *:443</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mode
tcp</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option tcplog</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
acl is_att path_beg -i /AttestationService</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
acl is_his path_beg -i /HisPrivacyCAWebServices2</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
use_backend Att-https if is_att</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
use_backend His-https if is_his</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
default_backend WLM-https</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>backend
WLM-https</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mode&nbsp;&nbsp;&nbsp; tcp</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
balance roundrobin</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option tcplog</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option httpchk HEAD /WLMService HTTP/1.1\r\nHost:\ *:8181</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option ssl-hello-chk</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb1 hostname&gt; &lt;lb1 IP&gt;:8181 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb2 hostname&gt; &lt;lb2 IP&gt;:8181 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>backend
Att-https</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mode&nbsp;&nbsp;&nbsp; tcp</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
balance roundrobin</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option tcplog</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option httpchk HEAD /AttestationService HTTP/1.1\r\nHost:\ *:8181</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option ssl-hello-chk</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb1 hostname&gt; &lt;lb1 IP&gt;:8181 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb2 hostname&gt; &lt;lb2 IP&gt;:8181 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>backend
His-https</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mode&nbsp;&nbsp;&nbsp; tcp</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
balance roundrobin</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option tcplog</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option httpchk HEAD /HisPrivacyCAWebServices2/hisPrivacyCAWebService2?wsdl
HTTP/1.1\r\nHost:\ *:8181</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option ssl-hello-chk</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb1 hostname&gt; &lt;lb1 IP&gt;:8181 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;lb2 hostname&gt; &lt;lb2 IP&gt;:8181 check</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>listen stats
*:9000</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
stats enable</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
stats uri /</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
stats hide-version</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
stats realm OAT\ Haproxy</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
stats auth admin:&lt;admin pwd&gt;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Replace
the contents in the angle brackets with the load balancer server hostname and
IP.</p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Then,
start HAProxy</p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='border:solid windowtext 1.0pt !msorm;padding:0in !msorm'><span
style='color:#FFC000;background:black'># service haproxy start</span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Now
you are able to access HAProxy¡¯s statistics page through the url http://&lt;load
balancer_hostname&gt;:9000/ with username admin and password &lt;admin
password&gt;</p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Redo
the exact same steps to setup the other load balancer server.</p>

<h2 style='text-align:justify;text-justify:inter-ideograph'>&nbsp;</h2>

<h2 style='text-align:justify;text-justify:inter-ideograph'><a
name="_Toc407711415"><span class=MsoIntenseEmphasis><span style='font-weight:
normal;font-style:normal'>Enable Haproxy logging</span></span></a></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>In
order to enable to HAProxy logging, there are some changes to make. </span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>Create
new configuration file.</span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='border:solid windowtext 1.0pt !msorm;padding:0in !msorm'><span
class=MsoIntenseEmphasis><span style='color:#FFC000;background:black;
font-weight:normal;font-style:normal'># vim /etc/rsyslog.d/49-haproxy.conf</span></span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>Paste
the following setting in the /etc/rsyslog.d/49-haproxy.conf</span></span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'>$ModLoad imudp</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'>$UDPServerAddress 127.0.0.1</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'>$UDPServerRun 514</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'>local1.* -/var/log/haproxy_1.log</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>&nbsp;</span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>Then
start the rsyslog service </span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='color:#FFC000;background:black;
font-weight:normal;font-style:normal'># service rsyslog restart</span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>And
you are done. Check the HAProxy log in /var/log/haproxy*.log</span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>Be
sure to do the steps again on the other load balancer server.</span></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>&nbsp;</span></span></p>

<h2 style='text-align:justify;text-justify:inter-ideograph'><a
name="_Toc407711416"></a><a name="_Toc407183233"><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>Enable
the Haproxy ports in Firewalld</span></span></a></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>Create
the&nbsp;</span></span><span class=MsoIntenseEmphasis><span style='font-weight:
normal;font-style:normal'>/etc/firewalld/services/haproxy.xml</span></span><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>&nbsp;file
and paste the following lines:</span></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;?xml
version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;service&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;short&gt;HAProxy&lt;/short&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;description&gt;HAProxy
load-balancer&lt;/description&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;port
protocol=&quot;tcp&quot; port=&quot;8181&quot;/&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;port
protocol=&quot;tcp&quot; port=&quot;8080&quot;/&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;port
protocol=&quot;tcp&quot; port=&quot;442&quot;/&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;port
protocol=&quot;tcp&quot; port=&quot;443&quot;/&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;port
protocol=&quot;tcp&quot; port=&quot;3307&quot;/&gt;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>&lt;/service&gt;</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>Assign
correct&nbsp;SELinux&nbsp;context and file permissions to
the&nbsp;haproxy.xml&nbsp;file:</span></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'># cd /etc/firewalld/services<br>
# restorecon haproxy.xml<br>
# chmod 640 haproxy.xml</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>Update
the firewall configuration:</span></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;color:#FFC000;background:black'>#
firewall-cmd --permanent --add-service=haproxy<br>
# firewall-cmd --reload</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
class=MsoIntenseEmphasis><span style='font-weight:normal;font-style:normal'>&nbsp;</span></span></p>

<div style='border:none;border-bottom:solid #5B9BD5 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc407711417"><span class=MsoIntenseEmphasis><span
style='font-weight:normal;font-style:normal'>Deploy the Web Applications with
HA &amp; Load Balancer</span></span></a></h1>

</div>

<h2><a name="_Toc407711418"><span class=MsoIntenseEmphasis><span
style='font-weight:normal;font-style:normal'>Set up Keepalived</span></span></a></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>To
enable the virtual IP address we will use keepalived. </p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># yum install ¨Cy keepalived</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># chkconfig keepalived on</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Good,
keepalived is now installed. If you want to enable mail alert, be sure to
install sendmail. </p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Backup
the original keepalived configuration.</p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># mv /etc/ keepalived/keepalived.conf /etc/
keepalived/keepalived.bak.conf</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Before
we proceed with configuring keepalived itself, edit the following file and
apply the setting. </p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># echo &quot;net.ipv4.ip_nonlocal_bind=1&quot;
&gt;&gt; /etc/sysctl.conf</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># sysctl ¨Cp</span></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify;text-justify:
inter-ideograph'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
background:#D9D9D9'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Now let¡¯s
add the configuration for keepalived in the file
/etc/keepalived/keepalived.conf.</p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>global_defs {</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
notification_email {</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;
&lt;admin¡¯s email addr&gt;&nbsp; # The email address for notification</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp; }</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
notification_email_from &lt;from email addr&gt;&nbsp;&nbsp; # The from address
for the notification</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
smtp_server &lt;the mail server IP&gt;&nbsp; # Specify the SMTP server address</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
smtp_connect_timeout 30</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:#D9D9D9'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>}</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>vrrp_script
haproxy {</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp; script
&quot;killall -0 haproxy&quot;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
interval 2</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp; weight
2</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>}</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>vrrp_instance
50 {</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
virtual_router_id 50</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
advert_int 1</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
priority 101</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp; state
MASTER</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
interface eth0 # change to your network interface</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;smtp_alert&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
# activate email notification, optional</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
authentication {</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
auth_type PASS</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
auth_pass 1111</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp; }</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
virtual_ipaddress {</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
&lt;virtual IP&gt; dev eth0&nbsp;&nbsp; # The virtual IP address shared by the
two load balancers. Do change eth0 to the actual network interface</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp; }</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;
track_script {</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;
haproxy</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>&nbsp; }</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'>}</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>Voila,
let¡¯s save the configuration and start the service. </p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># service
keepalived start</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>The
next step is to install and configure keepalived on the second load balancer.
Repeat the previous steps on the second server starting from keepalived
installation. The only difference is the minor change in the configuration of
keeplived. Be sure to make two setting changes.</p>

<p class=MsoNormal>From:</p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000'>&nbsp; <span style='background:
black'>priority 101</span></span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000'>&nbsp; <span style='background:
black'>state MASTER</span></span></p>

<p><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'>To:</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif'>&nbsp; <span style='color:#FFC000;background:
black'>priority 100</span></span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000'>&nbsp; <span style='background:
black'>state BACKUP</span></span></p>

<h2>&nbsp;</h2>

<h2><a name="_Toc407711419">Deploy Mariadb and Galera Replicator</a></h2>

<p class=MsoNormal>Maria/Galera is synchronous multi-master cluster for Mariadb/InnoDB
database.&nbsp;Data committed on one server will be replicated across the whole
cluster, which prevents the cluster from the SNOF. </p>

<p class=MsoNormal>If you already have Mariadb installed, remove the mariadb
Server</p>

<p class=MsoNormal>Firstly, download the Codeship patched Mysql </p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'># yum install mariadb-galera-server
mariadb galera</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'># chkconfig mariadb on</span></p>

<p class=MsoNormal>Then, configure Mariadb Server, run the command below to set
the root password. </p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'># service mariadb start</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'># mysql_secure_installation</span></p>

<p class=MsoNormal>Repeat the same steps on the second and the third database
server.</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc407711420">Setup Web Applications</a></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'>In
OAT, one attestation server has its own set of endorsement certificate and
PrivacyCA certificate generated upon server setup.&nbsp; In the HA
implementation, there are two or more web applications to offload each
other.&nbsp; However, only one set of certificates will be created and used in
the cluster. Therefore, the certificate will be generated on one server and
transfered to other servers hosting web applications. </p>

<p class=MsoNormal>Regarding how to install the OAT server, on the first
server, download and compile the source code from git source (<a
href="https://github.com/OpenAttestation/OpenAttestation"><span
style='font-size:11.0pt;line-height:110%'>https://github.com/OpenAttestation/OpenAttestation</span></a>)
to $HOME folder</p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'># git checkout
v2.2</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'># cd
$HOME/OpenAttestation/</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'># mvn clean
install</span></p>

<p style='margin:0in;margin-bottom:.0001pt'><span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:#FFC000;background:black'># cd deploy</span></p>

<p class=MsoNormal>And redo it on the other oat web server. </p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># ./deploy_fedora_ha.sh
--mysql &lt;mysql password&gt; --ip &lt;The virtual IP&gt; --port &lt;the
oatserver port on load balancer&gt; --mysql_port &lt;the mysql port on load
balancer&gt;</span></p>

<p class=MsoNormal>Notice: the parameter port here is the oat server https port
on the load balancer. It was set as 443 in /etc/haproxy/haproxy.cfg in our
implementation.</p>

<p class=MsoNormal>On the second server:</p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># cd $HOME/</span><span
style='font-size:11.0pt;line-height:110%;color:#FFC000;background:black'>
OpenAttestation/deploy</span></p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># ./deploy_fedora_ha.sh
--mysql &lt;mysql password&gt; --ip &lt;The virtual IP&gt; --ha_master &lt;the first
server IP&gt;</span></p>

<p class=MsoNormal>Here the ha_master is the IP/hostname of the first web
server deployed.</p>

<div style='border:none;border-bottom:solid #5B9BD5 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc407711421">Deploy Mariadb with HA</a> </h1>

</div>

<h2><a name="_Toc407711422">Galera Configuration with Three-node Cluster</a></h2>

<p class=MsoNormal>After setting up the mysql server, let¡¯s configure the
Galera replicator:</p>

<p class=MsoNormal>First of all, create a mysql user ¡°sst¡± for wsrep sst
communication:</p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'># mysql ¨Curoot ¨Cp&lt;password&gt; mysql ¨Ce ¡°create user&nbsp; sst@¡¯%¡¯ IDENTIFIED BY 'yourpass'; GRANT ALL PRIVILEGES ON *.* TO sst@'%' IDENTIFIED BY 'yourpass';&quot;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'># mysql -uroot ¨Cp&lt;password&gt; mysql -e &quot;GRANT ALL PRIVILEGES ON *.* TO 'sst'@'localhost' IDENTIFIED BY 'yourpass&quot;;</span></pre>

<p class=MsoNormal>Remove user accounts with empty user names because they
cause problems:</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='color:#FFC000;background:black'># mysql ¨Curoot
¨Cp&lt;password&gt; mysql -e &quot;DELETE FROM mysql.user WHERE user='';&quot;</span></p>

<p class=MsoNormal>Then open the firewall port:</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='color:#FFC000;background:black'># firewall-cmd --permanent</span><span
style='font-size:11.0pt;color:#FFC000;background:black'> </span><span
style='color:#FFC000;background:black'>--add-port=3306/tcp</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='color:#FFC000;background:black'># firewall-cmd --permanent</span><span
style='font-size:11.0pt;color:#FFC000;background:black'> </span><span
style='color:#FFC000;background:black'>--add-port=4567/tcp</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='color:#FFC000;background:black'># firewall-cmd --permanent</span><span
style='font-size:11.0pt;color:#FFC000;background:black'> </span><span
style='color:#FFC000;background:black'>--add-port=4444/tcp</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='color:#FFC000;background:black'># firewall-cmd --permanent</span><span
style='font-size:11.0pt;color:#FFC000;background:black'> </span><span
style='color:#FFC000;background:black'>--add-port=4568/tcp</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='color:#FFC000;background:black'># firewall-cmd --reload</span></p>

<p class=MsoNormal>After that, let¡¯s begin the configuration: </p>

<p class=MsoNormal>Edit /etc/my.cnf.d/server.cnf, add the following content
under [galera] section:</p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_provider=/usr/lib64/galera/libgalera_smm.so #it could be located in /usr/lib/galera/ libgalera_smm.so<b> </b>depends on the platform</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_cluster_address=gcomm://</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_node_address=&lt;first db server IP&gt;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_sst_method=rsync</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_sst_auth=sst:&lt;yourpass&gt;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_cluster_name=&quot;my_wsrep_cluster&quot;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>binlog_format=row</span></pre><pre><span style='font-size:
10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;background:black'>wsrep_slave_threads=1</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>default_storage_engine=InnoDB</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>innodb_autoinc_lock_mode=2</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>query_cache_size=0</span></pre>

<p class=MsoNormal>Edit /etc/my.cnf.d/galera.cnf and change the setting:</p>

<p class=MsoNormal><span style='color:#FFC000;background:black'>wsrep_provider=/usr/lib64/galera/libgalera_smm.so
</span></p>

<p class=MsoNormal>Move onto the second server:</p>

<p class=MsoNormal>Edit /etc/my.cnf.d/server.cnf, add the following content
under [galera] section:</p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_provider=/usr/lib64/galera/libgalera_smm.so #it could be located in /usr/lib/galera/ libgalera_smm.so<b> </b>depends on the platform</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_cluster_address=gcomm://&lt;first db server IP&gt;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_node_address=&lt;second db server IP&gt;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_sst_method=rsync</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_sst_auth=sst:&lt;yourpass&gt;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_cluster_name=&quot;my_wsrep_cluster&quot;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>binlog_format=row</span></pre><pre><span style='font-size:
10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;background:black'>wsrep_slave_threads=1</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>default_storage_engine=InnoDB</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>innodb_autoinc_lock_mode=2</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>query_cache_size=0</span></pre>

<p class=MsoNormal>Edit /etc/my.cnf.d/galera.cnf and change the setting:</p>

<p class=MsoNormal><span style='color:#FFC000;background:black'>wsrep_provider=/usr/lib64/galera/libgalera_smm.so
</span></p>

<p class=MsoNormal><span style='color:black'>OK, let¡¯s re-launch mariadb/mysql service
to apply the settings.</span></p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># service
mariadb restart</span></p>

<p class=MsoNormal>Then, restart the service on the second db server to let it
join the cluster.</p>

<p class=MsoNormal><span style='color:black'>Now the configuration is done and
the service is up. Let¡¯s check the wsrep status. </span></p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># mysql ¨Cusst ¨Cp&lt;yourpass&gt;
-e &quot;show status like 'wsrep%';&quot; | egrep
'wsrep_ready|wsrep_cluster_size'</span></p>

<p class=MsoNormal><span style='color:black'>The result should look like this.
If any of the return values does not match the result below, you will have to
verify your configurations and restart MySQL.</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>wsrep_cluster_size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>wsrep_ready&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000'>&nbsp;</span></p>

<p class=MsoNormal><span style='color:black'>OK, now the galera cluster works. </span><span
lang=EN>In order to avoid any split-brain situation, the cluster is recommended
to have at least three nodes. So add one more database node into the cluster. Redo
the same steps as the second node. The only difference is the setting listed
below. </span></p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_cluster_address=gcomm://&lt;second db server IP&gt;</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'>wsrep_node_address=&lt;third db server IP&gt;</span></pre>

<p class=MsoNormal>Restart the mariadb service on the third node:<br>
<span style='color:#FFC000;background:black'># service mariadb restart</span></p>

<p class=MsoNormal>Check the size of the cluster and it should be 3 now.</p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># mysql
¨Cu&lt;username&gt; ¨Cp&lt;password&gt; -e &quot;show status like 'wsrep%';&quot;
| grep ¡®wsrep_cluster_size'</span></p>

<p class=MsoNormal>That¡¯s it! Check the replication by creating databases,
tables and fields.</p>

<p class=MsoNormal><b>Important note:</b> when your 3 node replication is
setup, change the address of the node with this gcomm:// address by gcomm://&lt;third&nbsp;
db server IP&gt;. </p>

<p class=MsoNormal><b>Tips</b>: if you are able to setup mariadb galera
cluster, you are able to find more detailed info in /var/log/mariadb/mariadb.log.</p>

<h2>&nbsp;</h2>

<h2><a name="_Toc407711423">Configure SELinux for Galera</a></h2>

<p class=MsoNormal>If you have the SELinux enabled in enforcing mode, the SELinux
should be set up to allow galera. </p>

<p class=MsoNormal>The basic idea is to let the MariaDB Galera nodes run under
permissive mode in order to get all&nbsp;possible&nbsp;operations (which
SELinux would have otherwise denied) logged into the audit log and then create
a policy module using</span> allow2audit&nbsp;tool after carefully analyzing
the ¡°denials¡±. This module can then be installed before enabling (enforcing)
SELinux.</p>

</span>

<p class=MsoNormal>First of all, Install SELinux policy management tools</p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'># yum install policycoreutils</span></pre>

<p class=MsoNormal>Secondly, put SELinux in permissive mode on all the mariadb
hosts</p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'># setenforce 0</span></pre>

<p class=MsoNormal>On Host 1:</p>

<p class=MsoNormal>Start the service (as the donor node), when SELinux is in
permissive mode, it basically logs all the denial operations as warnings during
service startup.</p>

</span><pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'># service mariadb restart</span></pre>

<p class=MsoNormal>Wait for the joiner node Host 2 to join the cluster by
restart the mariadb service on Host 2.</p>

<p class=MsoNormal>Stop the service on Host 1, edit /etc/my.cnf.d/server.cnf
and replace gnome:// with gnome://&lt;second host IP&gt; and restart the
service again to join the existing cluster (as the joiner node).</p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'># service mariadb restart</span></pre>

<p class=MsoNormal>Once the node succeeds to join the cluster, let¡¯s capture
the audit log and define a new policy.</p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'># grep mysqld /var/log/audit/audit.log | audit2allow -M galera</span></pre><pre><span
style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'># semodule -i galera.pp</span></pre>

<p class=MsoNormal>Put the SELinux back to enforcing mode and restart the
mariadb service again to verify the new policy. </p>

<pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;color:#FFC000;
background:black'># setenforce 1</span></pre>

<p class=MsoNormal>On Host 2 and Host 3:</p>

<p class=MsoNormal>Follow the steps performed for Host 1. <span
class=apple-converted-space><span style='font-family:"Arial",sans-serif;
color:#2B2B2B;background:white'>&nbsp;</span></span>Note: the node will be
started as the ¡°joiner node¡± and would later become the ¡°donor¡±.</p>

</span><pre><span style='font-size:10.5pt;font-family:"Calibri",sans-serif;
color:#FFC000;background:black'>&nbsp;</span></pre>

<h2><a name="_Toc407711424">Configure Mariadb with HA &amp; Load Balancers</a></h2>

<p class=MsoNormal>For the time being, there are three database nodes. In OAT,
one single entry point is needed to access the database.&nbsp; To avoid SNOF, a
HAProxy is to set up on top of the existing Galera cluster. </p>

<p class=MsoNormal>Add the following configurations to the bottom of /etc/haproxy/haproxy.cfg.
Redo this on the other load balancer server.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>listen galera_cluster *:3307</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mode tcp</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
balance roundrobin</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option tcpka</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
option mysql-check user haproxy</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;db server1 hostname&gt; &lt;db server1 IP&gt;:3306 check weight 1</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;db server2 hostname&gt; &lt;db server2 IP&gt;:3306 check weight 1</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='color:#FFC000;background:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server &lt;db server3 hostname&gt; &lt;db server3 IP&gt;:3306 check weight 1</span></p>

<p class=MsoNormal>When you specify the option mysql-check with a username. You
need to add a user in the mysql database like this:</p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># mysql
¨Cu&lt;username&gt; -p&lt;password&gt; mysql -e ¡°insert into user(Host, User)
values(¡®%¡¯, ¡®haproxy¡¯); flush privileges;¡±</span></p>

<p class=MsoNormal>Reboot HAProxy.</p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># service
haproxy restart</span><br>
When it is done, update the OAT server configuration with the latest connection
string. </p>

<p class=MsoNormal>Remember to make the same change on the other web
application server. Restart tomcat to take effect. </p>

<p class=MsoNormal><span style='color:#FFC000;background:black'># service
tomcat restart</span></p>

<p class=MsoNormal>OK. Finally we have the complete initial OAT HA environment
setup in a three-node cluster.</p>

<p class=MsoNormal>Now, you are able to access the oat web portal by http://&lt;virtual
IP&gt;:442/TrustDashBoard/login.htm and http://&lt;virtual IP&gt;:442/WhiteListPortal/login.htm</p>

<div style='border:none;border-bottom:solid #5B9BD5 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc407711425">Recover after a Failure</a></h1>

</div>

<h2><a name="_Toc407711426"></a><a name="_Toc404695206">Reboot a Failed Node</a></h2>

<p class=MsoNormal>If there is a system failure or upgrade which needs a system
reboot, check the running status of the keepalived, haproxy, tomcat and mysql
service. If any of them fail to start, restart them or check the error log for
details.&nbsp; </p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc407711427"></a><a name="_Toc404695207">Replace a Failed Node</a></h2>

<p class=MsoNormal>If one of the nodes comes across some hardware failure or
system crash, to setup a new node to join the HA cluster, please follow this
guide to build a fresh node. </p>

<div style='border:none;border-bottom:solid #5B9BD5 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc407711428">References</a></h1>

</div>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Setup
Haproxy. <a
href="http://www.leaseweblabs.com/2011/07/high-availability-load-balancing-using-haproxy-on-ubuntu-part-1/#comment-79665">http://www.leaseweblabs.com/2011/07/high-availability-load-balancing-using-haproxy-on-ubuntu-part-1/#comment-79665</a>
</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Setup
Keepalived. <a
href="http://www.leaseweblabs.com/2011/09/setting-up-keepalived-on-ubuntu-load-balancing-using-haproxy-on-ubuntu-part-2/"><span
style='font-size:11.0pt;line-height:110%;color:windowtext'>http://www.leaseweblabs.com/2011/09/setting-up-keepalived-on-ubuntu-load-balancing-using-haproxy-on-ubuntu-part-2/</span></a></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-size:11.0pt;line-height:110%;color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;line-height:110%;color:black'>HAProxy
logging. </span><a href="http://kvz.io/blog/2010/08/11/haproxy-logging/"><span
style='font-size:11.0pt;line-height:110%'>http://kvz.io/blog/2010/08/11/haproxy-logging/</span></a></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-size:11.0pt;line-height:110%;color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;line-height:110%;color:black'>Mysql-Galera.
</span><a
href="http://www.sebastien-han.fr/blog/2012/04/01/mysql-multi-master-replication-with-galera/"><span
style='font-size:11.0pt;line-height:110%'>http://www.sebastien-han.fr/blog/2012/04/01/mysql-multi-master-replication-with-galera/</span></a></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
class=MsoHyperlink><span style='font-size:11.0pt;line-height:110%;color:black;
text-decoration:none'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style='font-size:11.0pt;line-height:110%;color:black'>Mysql-Galera
with HAProxy. </span><a
href="http://www.sebastien-han.fr/blog/2012/04/08/mysql-galera-cluster-with-haproxy/"><span
style='font-size:11.0pt;line-height:110%'>http://www.sebastien-han.fr/blog/2012/04/08/mysql-galera-cluster-with-haproxy/</span></a></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='color:black'>Configure SELinux for Galera. </span><span
class=MsoHyperlink><span style='font-size:11.0pt;line-height:110%'>http://nirbhay.in/2014/08/selinux-for-galera-cluster/</span></span></p>

<p style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif;
color:black'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
